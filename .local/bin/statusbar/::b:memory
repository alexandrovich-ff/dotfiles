#!/bin/sh

# vim: filetype=i3blocks
#  __  __ _____ __  __  ___  ______   __
# |  \/  | ____|  \/  |/ _ \|  _ \ \ / /
# | |\/| |  _| | |\/| | | | | |_) \ V / 
# | |  | | |___| |  | | |_| |  _ < | |  
# |_|  |_|_____|_|  |_|\___/|_| \_\|_|  
#
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸
# ÐÐ°Ð¿Ð¸ÑÐ°Ð½: @alexandrovich.ff
# Website: http://malikov.red

case $BLOCK_BUTTON in
	1) notify-send "ðŸ§  RAM Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹" "$(ps axch -o cmd:15,%mem --sort=-%mem | head)" ;;
esac

TYPE="${BLOCK_INSTANCE:-mem}"

awk -v type=$TYPE '
/^MemTotal:/ {
    mem_total=$2
}
/^MemFree:/ {
    mem_free=$2
}
/^Buffers:/ {
    mem_free+=$2
}
/^Cached:/ {
    mem_free+=$2
}
/^SwapTotal:/ {
    swap_total=$2
}
/^SwapFree:/ {
    swap_free=$2
}
END {
    if (type == "swap")
        printf("%.1fG\n", (swap_total-swap_free)/1024/1024)
    else
        printf("%.1fG\n", mem_free/1024/1024)
}
' /proc/meminfo
